{"ast":null,"code":"var _jsxFileName = \"/Users/kiritoshimura/Desktop/coffee-app/src/views/OrderConfirm.js\",\n    _s = $RefreshSig$();\n\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useState, useEffect } from \"react\";\nimport { useHistory } from 'react-router-dom';\nimport firebase from \"firebase/compat/app\";\nimport 'firebase/compat/firestore';\nimport Button from '@material-ui/core/Button'; // components\n\nimport { newCart } from '../store/index';\nimport { GetItemById, GetDiscountByCoupon } from '../components/Items'; // material ui\n\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport Filter1Icon from '@material-ui/icons/Filter1';\nimport Filter2Icon from '@material-ui/icons/Filter2';\nimport Filter3Icon from '@material-ui/icons/Filter3';\nimport Filter4Icon from '@material-ui/icons/Filter4';\nimport WarningIcon from '@material-ui/icons/Warning';\nimport CreditCardIcon from '@material-ui/icons/CreditCard';\nimport MonetizationOnIcon from '@material-ui/icons/MonetizationOn'; // import TableContainer from '@material-ui/core/TableContainer';\n\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport ShopIcon from '@material-ui/icons/Shop'; // import Paper from '@material-ui/core/Paper';\n\nimport Typography from '@material-ui/core/Typography'; // axios\n\nimport axios from 'axios';\nimport { sendMail } from '../components/SendMail';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction OrderConfirm() {\n  _s();\n\n  //まとめる　＋カートの情報も　state.cart.cartItemListでとってこれる\n  const [name, setName] = useState('');\n  const [email, setEmail] = useState('');\n  const [addNumber, setAddNumber] = useState('');\n  const [addNumberError, setAddNumberError] = useState('');\n  const [address, setAddress] = useState('');\n  const [orderDate, setOrderDate] = useState('');\n  const [orderTime, setOrderTime] = useState('');\n  const [tel, setTel] = useState('');\n  const [status, setStatus] = useState('');\n  const [errors, setErrors] = useState([]); //エラーの配列\n  // const [buyer,setBuyer] =useState({})//注文者情報\n\n  const [cartItemList, setCartItemList] = useState([]);\n  const [couponCode, setCouponCode] = useState(''); //クーポン\n\n  const [couponCodes, setCouponCodes] = useState([]); //クーポンs\n\n  const [couponFrag, setCouponFrag] = useState(false); //クーポンが使われたかどうか\n\n  const [couponPrice, setCouponPrice] = useState(''); //割引額\n\n  const [Coupons, setCoupons] = useState(''); //クーポンのバリデーション\n  //firebase ここから\n\n  const dispatch = useDispatch();\n  const state = useSelector(state => state);\n  const history = useHistory();\n\n  const handleLink = path => history.push(path);\n\n  const allowCoupon = () => {\n    if (!couponFrag) {\n      for (let i = 0; i < Coupons.length; i++) {\n        if (Coupons[i].code === couponCode) {\n          setCouponFrag(true);\n          setCouponPrice(Coupons[i].price);\n          setCouponCodes([...couponCodes, couponCode]);\n          console.log(`クーポンはありました${Coupons[i].price}円の割引です`);\n        }\n      }\n    }\n  };\n\n  const getAddress = () => {\n    console.log(GetDiscountByCoupon(c, couponCode) + a, 0);\n\n    if (/^\\d{3}-\\d{4}$/.test(addNumber)) {\n      setAddNumberError('');\n      axios.get('https://api.zipaddress.net/', {\n        params: {\n          zipcode: addNumber\n        }\n      }).then(res => {\n        if (res.data.code === 404) {\n          setAddNumberError('郵便番号が存在しません');\n        } else {\n          setAddress(res.data.data.address);\n        }\n      });\n    } else {\n      setAddNumberError('郵便番号の指定が合っていません');\n      setAddress('error');\n    }\n  };\n\n  const AddCartFire = by => {\n    // by = 購入者情報\n    const newOrder = Object.assign(by, {\n      cartItemList: state.cart.cartItemList\n    }); // coupon追加するならここ           \n\n    sendMail(newOrder); // add history\n\n    firebase.firestore().collection(`users/${state.user.uid}/carts`).doc(state.cart.uid).update(newOrder).then(d => {\n      dispatch({\n        type: 'ADD_ORDERHISTORY',\n        payload: {\n          uid: state.cart.uid,\n          orderhistory: newOrder\n        }\n      });\n    }); // create cate\n\n    firebase.firestore().collection(`users/${state.user.uid}/carts`).add(newCart).then(d => {\n      const newCarts = Object.assign({}, newCart);\n      newCarts.uid = d.id;\n      newCarts.cartItemList = [];\n      dispatch({\n        type: 'CREATE_CART',\n        payload: {\n          cart: newCarts\n        }\n      });\n    });\n    handleLink('orderfinish');\n  };\n\n  const changeName = e => {\n    setName(e.target.value);\n  };\n\n  const changeEmail = e => {\n    setEmail(e.target.value);\n  };\n\n  const changeAddNumber = e => {\n    setAddNumber(e.target.value);\n  };\n\n  const changeAddress = e => {\n    setAddress(e.target.value);\n  };\n\n  const changeTel = e => {\n    setTel(e.target.value);\n  };\n\n  const changeOrderDate = e => {\n    setOrderDate(e.target.value);\n  };\n\n  const changeOrderTime = e => {\n    setOrderTime(e.target.value);\n  };\n\n  const changeStatus = e => {\n    setStatus(e.target.value);\n  };\n\n  const changeCouponCode = e => {\n    setCouponCode(e.target.value);\n  };\n\n  const validEmail = email => {\n    let re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(email);\n  }; //メールアドレスのバリデーション\n\n\n  const validZipaddress = addNumber => {\n    let re = /^\\d{3}-\\d{4}$/;\n    return re.test(addNumber); //郵便番号の表記のバリデーション\n  };\n\n  const validPhone = tel => {\n    let re = /^\\d{3}-\\d{4}-\\d{4}$/;\n    return re.test(tel); //電話番号の表記のバリデーション\n  }; //日付のバリデーション　-始まり-\n\n\n  const validOrderdate = orderDate => {\n    //本日\n    let today = new Date();\n    today = new Date(today.getFullYear(), today.getMonth(), today.getDate(), today.getHours());\n    let date1 = new Date(orderDate);\n    let nowDay = today.getDate();\n    let date = new Date(date1);\n    let selectedMonth = date1.getMonth(); //選択した月\n\n    let nowMonth = today.getMonth();\n    let selectedDay = date1.getDate();\n    let nowHour = today.getHours();\n    let a = Math.abs(orderTime - nowHour);\n\n    if (nowMonth < selectedMonth) {\n      console.log(`trueだよ`);\n      return true;\n    } else if (nowMonth === selectedMonth) {\n      console.log(`同じ月です`);\n\n      if (nowDay === selectedDay) {\n        console.log('同じ日付です');\n\n        if (orderTime <= nowHour) {\n          console.log('時間がおかしいです');\n          return false;\n        } else if (3 <= a) {\n          console.log('時間は正常です');\n          return true;\n        } else {\n          return false;\n        }\n      } //ここまで同じ日の場合の処理\n      else if (nowDay > selectedDay) {\n        console.log('本日以降の日付を選択してください');\n        return false;\n      } else {\n        return true;\n      }\n    }\n  }; // 日付のバリデーション　-終わり-\n\n\n  const checkValid = () => {\n    //配列をからにする\n    setErrors('');\n    let allError = [];\n\n    if (!name) {\n      allError.push(\"名前を入力してください\");\n    }\n\n    if (!email) {\n      allError.push(\"メールアドレスを入力してください\");\n    } else if (!validEmail(email)) {\n      allError.push(\"メールアドレスを正しい形式で入力してください\");\n    }\n\n    if (!addNumber) {\n      allError.push(\"郵便番号を入力してください\");\n    } else if (!validZipaddress(addNumber)) {\n      allError.push(\"郵便番号は、ハイフンをつけて半角でご入力ください\");\n    }\n\n    if (!address) {\n      allError.push(\"住所を入力してください\");\n    }\n\n    if (!orderDate) {\n      allError.push(\"配達日を入力してください\");\n    } else if (!validOrderdate(orderDate)) {\n      allError.push(\"配達日時は今から3時間後以降をご選択ください\");\n    }\n\n    if (!orderTime) {\n      allError.push(\"配達時間をご選択ください\");\n    }\n\n    if (!tel) {\n      allError.push(\"電話番号を入力してください\");\n    } else if (!validPhone(tel)) {\n      allError.push(\"電話番号は、ハイフンをつけて半角でご入力ください\");\n    }\n\n    if (!status) {\n      allError.push(\"支払い方法を選択してください\");\n    }\n\n    setErrors(allError);\n\n    if (allError.length === 0) {\n      let objName = {\n        name: name\n      };\n      let objEmail = {\n        email: email\n      };\n      let objAddnumber = {\n        addNumber: addNumber\n      };\n      let objAddress = {\n        address: address\n      };\n      let objOrderDate = {\n        orderDate: orderDate\n      };\n      let objOrderTime = {\n        orderTime: orderTime\n      };\n      let objTel = {\n        tel: tel\n      };\n      let objStatus = {\n        status: status\n      };\n      let objcouponCode = {\n        couponCode: couponCode\n      };\n      let BuyerObj = Object.assign({}, objName, objEmail, objAddnumber, objAddress, objOrderDate, objOrderTime, objTel, objStatus, objcouponCode); // setBuyer(BuyerObj);\n\n      AddCartFire(BuyerObj);\n    }\n  };\n\n  useEffect(() => {\n    let newCartItemList = state.cart.cartItemList;\n\n    if (newCartItemList) {\n      // cartのIDを全て商品情報に変換 Item, Topping, subtotal を追加\n      const newCouponCodes = couponCodes.concat();\n      newCartItemList = newCartItemList.map(c => {\n        c.Item = GetItemById(c.Itemid, state.Coffee);\n        c.Topping = c.toppingid.map(t => GetItemById(t, state.Topping));\n        c.subtotal = (c.Item[c.price] + c.Topping.reduce((ac, cu) => ac + cu[c.price], 0)) * c.number;\n\n        if (c.Item.couponCode) {\n          for (let i = 0; i < c.number; i++) {\n            newCouponCodes.push(c.Item.couponCode);\n          }\n        }\n\n        return c;\n      });\n      newCouponCodes.length !== 0 && setCouponCodes(newCouponCodes);\n      setCartItemList(newCartItemList);\n    } else {\n      handleLink('/cart');\n    }\n  }, [state.cart]);\n  useEffect(() => {\n    setCoupons(state.Coupon);\n  }, [state.Coupon]);\n  useEffect(() => {\n    if (!state.user.uid) {\n      handleLink('/cart');\n    }\n  }, [state.user]);\n  const addNumberErrorMes = {\n    fontSize: \"50%\",\n    color: \"red\",\n    position: \"absolute\"\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [/*#__PURE__*/_jsxDEV(Filter1Icon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 11\n      }, this), \"\\xA0\\u6CE8\\u6587\\u5185\\u5BB9\\u3092\\u3054\\u78BA\\u8A8D\\u304F\\u3060\\u3055\\u3044\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      \"aria-label\": \"simple table\",\n      children: [/*#__PURE__*/_jsxDEV(TableHead, {\n        className: \"chumon-head\",\n        children: /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u5546\\u54C1\\u540D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u30B5\\u30A4\\u30BA\\u3001\\u4FA1\\u683C\\u3001\\u6570\\u91CF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u30C8\\u30C3\\u30D4\\u30F3\\u30B0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u5408\\u8A08\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n        className: \"chumon\",\n        children: cartItemList.map((c, index) => {\n          return /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: `${process.env.PUBLIC_URL}/${c.Item.image}`,\n              height: \"100px\",\n              alt: \"\\u5546\\u54C1\",\n              style: {\n                borderRadius: 5\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              component: \"th\",\n              scope: \"row\",\n              children: c.Item.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: [c.price.replace('price', '') + 'サイズ', \"\\u3001\", c.Item[c.price], \"\\u5186\\u3001\", c.number, \"\\u500B\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                children: c.Topping.map((t, i) => {\n                  return /*#__PURE__*/_jsxDEV(\"li\", {\n                    children: [t.name, \"\\u3001\", t[c.price], \"\\u5186\"]\n                  }, i, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 365,\n                    columnNumber: 21\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 362,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: [c.subtotal, \"\\u5186\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 15\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 13\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      style: {\n        backgroundColor: \"rgb(70, 77, 180)\"\n      },\n      children: [\"\\u5408\\u8A08\\u91D1\\u984D\\uFF1A\", cartItemList.reduce((a, c) => c.subtotal + a, 0), \"\\u5186\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [/*#__PURE__*/_jsxDEV(Filter2Icon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this), \"\\xA0\\u304A\\u5BA2\\u3055\\u307E\\u60C5\\u5831\\u3092\\u5165\\u529B\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      children: /*#__PURE__*/_jsxDEV(TableBody, {\n        children: [/*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u304A\\u540D\\u524D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 4\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: name,\n              onChange: changeName,\n              placeholder: \"\\u30E9\\u30AF\\u30E9\\u30AF \\u592A\\u90CE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 4\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 3\n        }, this), /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 4\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: email,\n              onChange: changeEmail,\n              placeholder: \"rakus@coffee.co.jp\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 4\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 3\n        }, this), /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u90F5\\u4FBF\\u756A\\u53F7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 4\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: addNumber,\n              onChange: changeAddNumber,\n              placeholder: \"000-0000\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 10\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              onClick: getAddress,\n              children: \"\\u90F5\\u4FBF\\u756A\\u53F7\\u304B\\u3089\\u4F4F\\u6240\\u5165\\u529B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 406,\n              columnNumber: 10\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: addNumberErrorMes,\n              children: addNumberError\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 407,\n              columnNumber: 10\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 4\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u4F4F\\u6240\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 5\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: address,\n              onChange: changeAddress,\n              placeholder: \"\\u6771\\u4EAC\\u90FD\\u65B0\\u5BBF\\u533A4-3-25\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 414,\n            columnNumber: 4\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u96FB\\u8A71\\u756A\\u53F7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 419,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: tel,\n              onChange: changeTel,\n              placeholder: \"000-0000-0000\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 4\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u914D\\u9054\\u65E5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 5\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              value: orderDate,\n              onChange: changeOrderDate\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 432,\n              columnNumber: 7\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"\\u914D\\u9054\\u6642\\u9593\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(\"select\", {\n              name: \"pets\",\n              id: \"pet-select\",\n              value: orderTime,\n              onChange: changeOrderTime,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u6642\\u9593\\u3092\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 442,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"10\",\n                children: \"10\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 443,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"11\",\n                children: \"11\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"12\",\n                children: \"12\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 445,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"13\",\n                children: \"13\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 446,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"14\",\n                children: \"14\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 447,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"15\",\n                children: \"15\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 448,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"16\",\n                children: \"16\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 449,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"17\",\n                children: \"17\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 450,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"18\",\n                children: \"18\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 451,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"19\",\n                children: \"19\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"20\",\n                children: \"20\\u6642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 441,\n              columnNumber: 7\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 4\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [/*#__PURE__*/_jsxDEV(Filter3Icon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 5\n      }, this), \"\\xA0\\u652F\\u6255\\u3044\\u65B9\\u6CD5\\u3092\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"radio\",\n        name: \"payment\",\n        value: \"1\",\n        onClick: changeStatus,\n        id: \"daibiki\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"daibiki\",\n        className: \"point\",\n        children: [/*#__PURE__*/_jsxDEV(MonetizationOnIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 52\n        }, this), \"\\xA0\\u4EE3\\u91D1\\u5F15\\u63DB\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 9\n      }, this), \"\\xA0\\xA0/\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"radio\",\n        name: \"payment\",\n        value: \"2\",\n        onClick: changeStatus,\n        id: \"cc\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"cc\",\n        className: \"point\",\n        children: [/*#__PURE__*/_jsxDEV(CreditCardIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 13\n        }, this), \"\\xA0\\u30AF\\u30EC\\u30B8\\u30C3\\u30C8\\u30AB\\u30FC\\u30C9\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 461,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [/*#__PURE__*/_jsxDEV(Filter4Icon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 472,\n        columnNumber: 7\n      }, this), \"\\u30AF\\u30FC\\u30DD\\u30F3\\u3092\\u9069\\u7528\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      value: couponCode,\n      onChange: changeCouponCode\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 473,\n      columnNumber: 8\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: allowCoupon,\n      style: {\n        backgroundColor: \"primary\"\n      },\n      children: \"\\u9069\\u7528\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 8\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      children: [\"\\u5272\\u5F15\\u91D1\\u984D:\", couponCodes.length === 0 ? 0 : couponCodes.reduce((a, c) => GetDiscountByCoupon(c, couponCode) + a, 0), \"\\u5186\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 475,\n      columnNumber: 8\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      style: {\n        backgroundColor: \"rgb(70, 77, 180)\"\n      },\n      children: [\"\\u5408\\u8A08\\u91D1\\u984D\\uFF1A\", cartItemList.reduce((a, c) => c.subtotal + a, 0) - couponPrice, \"\\u5186\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: errors.map((error, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n        id: \"error\",\n        children: [\" \", /*#__PURE__*/_jsxDEV(WarningIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 39\n        }, this), error]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 480,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      style: {\n        color: \"primary\",\n        backgroundColor: \"teal\",\n        height: \"55px\"\n      },\n      onClick: checkValid,\n      children: [/*#__PURE__*/_jsxDEV(ShopIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 124\n      }, this), \"\\u6CE8\\u6587\\u3059\\u308B\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 488,\n      columnNumber: 3\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 340,\n    columnNumber: 5\n  }, this);\n}\n\n_s(OrderConfirm, \"rM1pHLFxs9piltaY5cQtGFwOPsM=\", false, function () {\n  return [useDispatch, useSelector, useHistory];\n});\n\n_c = OrderConfirm;\nexport default OrderConfirm;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderConfirm\");","map":{"version":3,"sources":["/Users/kiritoshimura/Desktop/coffee-app/src/views/OrderConfirm.js"],"names":["useDispatch","useSelector","useState","useEffect","useHistory","firebase","Button","newCart","GetItemById","GetDiscountByCoupon","Table","TableBody","TableCell","Filter1Icon","Filter2Icon","Filter3Icon","Filter4Icon","WarningIcon","CreditCardIcon","MonetizationOnIcon","TableHead","TableRow","ShopIcon","Typography","axios","sendMail","OrderConfirm","name","setName","email","setEmail","addNumber","setAddNumber","addNumberError","setAddNumberError","address","setAddress","orderDate","setOrderDate","orderTime","setOrderTime","tel","setTel","status","setStatus","errors","setErrors","cartItemList","setCartItemList","couponCode","setCouponCode","couponCodes","setCouponCodes","couponFrag","setCouponFrag","couponPrice","setCouponPrice","Coupons","setCoupons","dispatch","state","history","handleLink","path","push","allowCoupon","i","length","code","price","console","log","getAddress","c","a","test","get","params","zipcode","then","res","data","AddCartFire","by","newOrder","Object","assign","cart","firestore","collection","user","uid","doc","update","d","type","payload","orderhistory","add","newCarts","id","changeName","e","target","value","changeEmail","changeAddNumber","changeAddress","changeTel","changeOrderDate","changeOrderTime","changeStatus","changeCouponCode","validEmail","re","validZipaddress","validPhone","validOrderdate","today","Date","getFullYear","getMonth","getDate","getHours","date1","nowDay","date","selectedMonth","nowMonth","selectedDay","nowHour","Math","abs","checkValid","allError","objName","objEmail","objAddnumber","objAddress","objOrderDate","objOrderTime","objTel","objStatus","objcouponCode","BuyerObj","newCartItemList","newCouponCodes","concat","map","Item","Itemid","Coffee","Topping","toppingid","t","subtotal","reduce","ac","cu","number","Coupon","addNumberErrorMes","fontSize","color","position","index","process","env","PUBLIC_URL","image","borderRadius","replace","backgroundColor","error","height"],"mappings":"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","sourcesContent":["import { useDispatch, useSelector } from \"react-redux\";\nimport { useState, useEffect } from \"react\";\nimport { useHistory } from 'react-router-dom';\nimport firebase from \"firebase/compat/app\";\nimport 'firebase/compat/firestore';\nimport Button from '@material-ui/core/Button';\n// components\nimport { newCart } from '../store/index'\nimport { GetItemById, GetDiscountByCoupon } from '../components/Items'\n// material ui\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport Filter1Icon from '@material-ui/icons/Filter1';\nimport Filter2Icon from '@material-ui/icons/Filter2';\nimport Filter3Icon from '@material-ui/icons/Filter3';\nimport Filter4Icon from '@material-ui/icons/Filter4';\nimport WarningIcon from '@material-ui/icons/Warning';\nimport CreditCardIcon from '@material-ui/icons/CreditCard';\nimport MonetizationOnIcon from '@material-ui/icons/MonetizationOn';\n// import TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport ShopIcon from '@material-ui/icons/Shop';\n\n// import Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n// axios\nimport axios from 'axios' \nimport { sendMail } from '../components/SendMail'\n\nfunction OrderConfirm() {\n\n  //まとめる　＋カートの情報も　state.cart.cartItemListでとってこれる\n  const [name, setName] = useState('');\n  const [email, setEmail] = useState('');\n  const [addNumber, setAddNumber] = useState('');\n  const [addNumberError, setAddNumberError] = useState('');\n  const [address, setAddress] = useState('');\n\n  const [orderDate, setOrderDate] = useState('');\n  const [orderTime, setOrderTime] = useState('');\n  const [tel, setTel] = useState('');\n  const [status, setStatus] = useState('');\n  const [errors, setErrors] = useState([]); //エラーの配列\n\n  // const [buyer,setBuyer] =useState({})//注文者情報\n  const [cartItemList, setCartItemList] = useState([])\n\n  const [couponCode, setCouponCode] = useState(''); //クーポン\n  const [couponCodes, setCouponCodes] = useState([]); //クーポンs\n  const [couponFrag,setCouponFrag] = useState(false) //クーポンが使われたかどうか\n  const [couponPrice,setCouponPrice] =useState('') //割引額\n  const [Coupons,setCoupons] =useState('')//クーポンのバリデーション\n\n  //firebase ここから\n  const dispatch = useDispatch();\n  const state = useSelector(state => state);\n  const history = useHistory()\n  const handleLink = path => history.push(path)\n\n  const allowCoupon=()=>{\n    if(!couponFrag){\n      for (let i = 0; i < Coupons.length; i++) {\n        if (Coupons[i].code === couponCode) {          \n          setCouponFrag(true)          \n          setCouponPrice(Coupons[i].price)\n          setCouponCodes([...couponCodes, couponCode])\n          console.log(`クーポンはありました${Coupons[i].price}円の割引です`)\n        }\n      }\n    }\n  }\n\n  const getAddress = () => {  \n    console.log(GetDiscountByCoupon(c, couponCode) + a , 0);  \n    if(/^\\d{3}-\\d{4}$/.test(addNumber)){\n      setAddNumberError('')\n      axios.get('https://api.zipaddress.net/'\n      ,{\n        params:{\n          zipcode: addNumber\n        }}\n      ).then(res => {\n        if(res.data.code === 404 ){\n          setAddNumberError('郵便番号が存在しません')\n        }else{\n          setAddress(res.data.data.address)\n        }\n      })\n    }else{\n      setAddNumberError('郵便番号の指定が合っていません')\n      setAddress('error')\n    }\n  }\n\n  const AddCartFire = (by) => {\n\n    // by = 購入者情報\n    const newOrder = Object.assign(by,{ cartItemList: state.cart.cartItemList } )   // coupon追加するならここ           \n    sendMail(newOrder)\n\n    // add history\n    firebase.firestore()\n            .collection(`users/${state.user.uid}/carts`)\n            .doc(state.cart.uid)\n            .update(newOrder)\n            .then( d => {\n              dispatch({ type:'ADD_ORDERHISTORY', payload:{ uid: state.cart.uid, orderhistory: newOrder }})\n            })\n\n    // create cate\n    firebase.firestore()\n              .collection(`users/${state.user.uid}/carts`)\n              .add(newCart)\n              .then( d => {\n                const newCarts = Object.assign({}, newCart)\n                newCarts.uid = d.id\n                newCarts.cartItemList = []\n                dispatch({ type:'CREATE_CART', payload:{ cart: newCarts }})\n              })\n    handleLink('orderfinish')\n  }\n\n  const changeName = (e) => {\n    setName(e.target.value);\n  };\n\n  const changeEmail = (e) => {\n    setEmail(e.target.value);\n  };\n\n  const changeAddNumber = (e) => {\n    setAddNumber(e.target.value);\n  };\n\n  const changeAddress = (e) => {\n    setAddress(e.target.value);\n  };\n\n  const changeTel = (e) => {\n    setTel(e.target.value);\n  };\n\n  const changeOrderDate = (e) => {\n    setOrderDate(e.target.value);\n  };\n\n  const changeOrderTime= (e) => {\n    setOrderTime(e.target.value);\n  };\n\n  const changeStatus= (e) => {\n    setStatus(e.target.value);\n  };\n\n  const changeCouponCode = (e) => {\n     setCouponCode(e.target.value);\n   };\n   \n  const  validEmail=(email)=>{\n    let re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(email);\n  }//メールアドレスのバリデーション\n\n  const validZipaddress=(addNumber)=>{\n    let re = /^\\d{3}-\\d{4}$/\n    return re.test(addNumber) //郵便番号の表記のバリデーション\n  }\n\n  const  validPhone = (tel) =>{\n    let re = /^\\d{3}-\\d{4}-\\d{4}$/\n    return re.test(tel) //電話番号の表記のバリデーション\n  }\n\n//日付のバリデーション　-始まり-\n\nconst validOrderdate=(orderDate)=>{\n  //本日\n  let today = new Date()\n  today = new Date(\n    today.getFullYear(),\n    today.getMonth(),\n    today.getDate(),\n    today.getHours()\n  )\n\n  let date1 = new Date(orderDate)\n  let nowDay = today.getDate()\n  let date = new Date (date1)\n\n  let selectedMonth = date1.getMonth() //選択した月\n  let nowMonth =today.getMonth()\n  let selectedDay = date1.getDate()\n  let nowHour = today.getHours()\n  let a = Math.abs(orderTime - nowHour)\n\n    if(nowMonth < selectedMonth){\n      console.log(`trueだよ`)\n      return true\n\n    }\n    else if(nowMonth === selectedMonth){\n      console.log(`同じ月です`)\n      if(nowDay === selectedDay){\n        console.log('同じ日付です')\n        if(orderTime <= nowHour){\n           console.log('時間がおかしいです')\n          return false\n        } else if( 3 <= a) {\n        console.log('時間は正常です')\n        return true\n        } else {\n        return false\n        }\n      }\n      //ここまで同じ日の場合の処理\n         else if(nowDay > selectedDay){\n        console.log('本日以降の日付を選択してください')\n        return false\n      }else{\n        return true\n      }\n     }\n    }\n\n\n// 日付のバリデーション　-終わり-\n\n\n  const checkValid = () => {\n\n    //配列をからにする\n    setErrors('')\n    let allError =[]\n\n    if (!name) {\n      allError.push(\"名前を入力してください\")\n    }\n    if (!email) {\n      allError.push(\"メールアドレスを入力してください\")\n    } else if(!validEmail(email)){\n      allError.push(\"メールアドレスを正しい形式で入力してください\")\n    }\n\n    if (!addNumber) {\n      allError.push(\"郵便番号を入力してください\")\n    } else if(!validZipaddress(addNumber)){\n      allError.push(\"郵便番号は、ハイフンをつけて半角でご入力ください\")\n    }\n\n\n    if (!address) {\n      allError.push(\"住所を入力してください\")\n    }\n\n    if (!orderDate) {\n      allError.push(\"配達日を入力してください\")\n    } else if(!validOrderdate(orderDate)){\n      allError.push(\"配達日時は今から3時間後以降をご選択ください\")\n    }\n\n    if (!orderTime) {\n      allError.push(\"配達時間をご選択ください\")\n    }\n    if (!tel) {\n      allError.push(\"電話番号を入力してください\")\n    } else if(!validPhone(tel)){\n      allError.push(\"電話番号は、ハイフンをつけて半角でご入力ください\")\n    }\n\n\n    if (!status) {\n      allError.push(\"支払い方法を選択してください\")\n    }\n    setErrors(allError)\n\n    if (allError.length === 0) {\n        let objName = {name:name}\n        let objEmail = {email:email}\n        let objAddnumber = {addNumber:addNumber}\n        let objAddress = {address:address}\n        let objOrderDate = {orderDate:orderDate}\n        let objOrderTime = {orderTime:orderTime}\n        let objTel = {tel:tel}\n        let objStatus = {status:status}\n        let objcouponCode ={couponCode:couponCode}\n\n        let BuyerObj =Object.assign({},objName, objEmail, objAddnumber,objAddress,objOrderDate,objOrderTime,objTel,objStatus,objcouponCode);\n        // setBuyer(BuyerObj);\n\n        AddCartFire(BuyerObj)\n    }\n  };\n\n  useEffect(()=>{\n    let newCartItemList = state.cart.cartItemList     \n    if(newCartItemList){\n      // cartのIDを全て商品情報に変換 Item, Topping, subtotal を追加\n      const newCouponCodes = couponCodes.concat()\n\n      newCartItemList = newCartItemList.map( c => {\n        c.Item = GetItemById(c.Itemid, state.Coffee)\n        c.Topping = c.toppingid.map( t => GetItemById(t, state.Topping) )\n        c.subtotal = ( c.Item[c.price] + c.Topping.reduce((ac,cu) => ac + cu[c.price],0)) * c.number        \n        if(c.Item.couponCode){          \n          for(let i = 0; i < c.number; i++ ){\n            newCouponCodes.push(c.Item.couponCode)\n          }\n        }\n        return c\n      })\n      newCouponCodes.length !== 0 && setCouponCodes(newCouponCodes)        \n      setCartItemList(newCartItemList)      \n    }\n    else{\n      handleLink('/cart')\n    }\n  },[state.cart])\n\n  useEffect(()=>{\n    setCoupons(state.Coupon)    \n  },[state.Coupon])\n\n  useEffect(()=>{\n    if(!state.user.uid){\n      handleLink('/cart')\n    }\n  },[state.user])\n\n\n  const addNumberErrorMes = {\n    fontSize: \"50%\",\n    color: \"red\",\n    position: \"absolute\",\n  }\n\n  return (\n\n    <div>\n      <h1><Filter1Icon />&nbsp;注文内容をご確認ください</h1>\n      <Table aria-label=\"simple table\">\n        <TableHead className='chumon-head'>\n          <TableRow>\n            <TableCell></TableCell>\n            <TableCell>商品名</TableCell>\n            <TableCell>サイズ、価格、数量</TableCell>\n            <TableCell>トッピング</TableCell>\n            <TableCell>合計</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody  className='chumon'>\n         {cartItemList.map((c, index) => {\n            return (\n            <TableRow key={index}>\n                <img src={`${process.env.PUBLIC_URL}/${c.Item.image}`} height=\"100px\" alt=\"商品\" style={{borderRadius:5}}/>\n                <TableCell component=\"th\" scope=\"row\">\n                {c.Item.name}\n              </TableCell>\n              <TableCell>{c.price.replace('price','') + 'サイズ'}、{c.Item[c.price]}円、{c.number}個</TableCell>\n              <TableCell>\n                <ul>\n                {c.Topping.map((t,i) => {\n                  return (\n                    <li key={i}>{t.name}、{t[c.price]}円</li>\n                  )\n                })}\n                </ul>\n              </TableCell>\n              <TableCell>{c.subtotal}円</TableCell>\n            </TableRow>)\n            })\n          }\n        </TableBody>\n      </Table>\n      <Typography variant=\"h6\" style={{backgroundColor:\"rgb(70, 77, 180)\"}}>合計金額：{cartItemList.reduce( (a,c) => c.subtotal + a, 0 )}円</Typography>\n\n\n\n    <h1><Filter2Icon />&nbsp;お客さま情報を入力してください</h1>\n\n  <Table>\n  \t<TableBody>\n\t\t<TableRow>\n\t\t\t<TableCell>\n          お名前\n      </TableCell>\n\t\t\t<TableCell>\n         <input type=\"text\" value={name} onChange={changeName} placeholder=\"ラクラク 太郎\"></input>\n      </TableCell>\n\t\t</TableRow>\n\t\t<TableRow>\n\t\t\t<TableCell>\n        メールアドレス\n      </TableCell>\n\t\t\t<TableCell>\n         <input type=\"text\" value={email} onChange={changeEmail} placeholder=\"rakus@coffee.co.jp\"></input>\n      </TableCell>\n    </TableRow>\n    <TableRow>\n\t\t\t<TableCell>\n          郵便番号\n      </TableCell>\n\t\t\t<TableCell>\n         <input type=\"text\" value={addNumber} onChange={changeAddNumber} placeholder=\"000-0000\"></input>\n         <Button onClick={getAddress}>郵便番号から住所入力</Button>\n         <span style={addNumberErrorMes}>{addNumberError}</span>\n      </TableCell>\n\t\t</TableRow>\n    <TableRow>\n    <TableCell>\n          住所\n      </TableCell>\n\t\t\t<TableCell>\n         <input type=\"text\" value={address} onChange={changeAddress}  placeholder=\"東京都新宿区4-3-25\"></input>\n      </TableCell>\n    </TableRow>\n    <TableRow>\n      <TableCell>\n          電話番号\n      </TableCell>\n\t\t\t<TableCell>\n         <input type=\"text\" value={tel} onChange={changeTel}　placeholder=\"000-0000-0000\"></input>\n      </TableCell>\n    </TableRow>\n\n    <TableRow>\n    <TableCell>\n          配達日\n        </TableCell>\n        <TableCell>\n      <input type=\"date\" value={orderDate} onChange={changeOrderDate}></input>\n      </TableCell>\n      </TableRow>\n\n      <TableRow>\n      <TableCell>\n          配達時間\n        </TableCell>\n        <TableCell>\n      <select name=\"pets\" id=\"pet-select\" value={orderTime} onChange={changeOrderTime}>\n        <option value=\"\">時間を選択してください</option>\n        <option value=\"10\">10時</option>\n        <option value=\"11\">11時</option>\n        <option value=\"12\">12時</option>\n        <option value=\"13\">13時</option>\n        <option value=\"14\">14時</option>\n        <option value=\"15\">15時</option>\n        <option value=\"16\">16時</option>\n        <option value=\"17\">17時</option>\n        <option value=\"18\">18時</option>\n        <option value=\"19\">19時</option>\n        <option value=\"20\">20時</option>\n    </select>\n    </TableCell>\n\t\t</TableRow>\n    </TableBody>\n    </Table>\n<p></p>\n<h1><Filter3Icon />&nbsp;支払い方法を選択してください</h1>\n  <div>\n        <input type=\"radio\"  name=\"payment\" value=\"1\" onClick={changeStatus} id='daibiki' />\n        <label htmlFor='daibiki' className='point'><MonetizationOnIcon />&nbsp;代金引換</label>\n        &nbsp;&nbsp;/&nbsp;&nbsp;\n        <input type=\"radio\"  name=\"payment\" value=\"2\" onClick={changeStatus} id='cc'/>\n          <label htmlFor='cc' className='point'>\n            <CreditCardIcon />&nbsp;クレジットカード\n          </label>\n  </div>\n  <p></p>\n\n  <h1><Filter4Icon />クーポンを適用</h1>\n       <input type=\"text\" value={couponCode} onChange={changeCouponCode}></input>\n       <Button onClick={allowCoupon} style={{backgroundColor: \"primary\" }}>適用</Button>\n       <Typography variant=\"h6\">割引金額:{couponCodes.length === 0 ? 0 : couponCodes.reduce((a,c) =>          \n         GetDiscountByCoupon(c, couponCode) + a , 0)}円</Typography>\n   <Typography variant=\"h6\" style={{backgroundColor:\"rgb(70, 77, 180)\"}}>合計金額：{cartItemList.reduce( (a,c) => c.subtotal + a, 0 )- couponPrice}円</Typography>\n\n  {/* エラー分 */}\n  <ul>\n        {errors.map((error, index) => (\n          <li key={index} id='error'> <WarningIcon />\n            {error}\n          </li>\n        ))}\n  </ul>\n  \n  <Button variant=\"contained\"   style={{ color: \"primary\", backgroundColor: \"teal\", height:\"55px\" }}  onClick={checkValid}><ShopIcon />注文する</Button>\n\n</div>\n)\n}\n\n\nexport default OrderConfirm\n"]},"metadata":{},"sourceType":"module"}