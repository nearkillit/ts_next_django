{"ast":null,"code":"var _jsxFileName = \"/Users/kiritoshimura/Desktop/coffee-app/src/views/OrderHistory.js\",\n    _s = $RefreshSig$();\n\nimport { useSelector } from \"react-redux\";\nimport { useState, useEffect } from \"react\";\nimport { GetItemById, GetDiscountByCoupon } from '../components/Items'; // material ui\n\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction OrderHistory() {\n  _s();\n\n  const state = useSelector(state => state);\n  const [order, setOrder] = useState([]);\n  const [couponCode, setCouponCode] = useState(''); //クーポンコード\n\n  const [couponPrice, setCouponPrice] = useState(''); //割引額\n\n  const [Coupons, setCoupons] = useState(''); //クーポン\n\n  const allowCoupon = () => {\n    for (let i = 0; i < Coupons.length; i++) {\n      if (Coupons[i].code === couponCode) {\n        let coupon = Coupons[i].price;\n      }\n    }\n  };\n\n  useEffect(() => {\n    let getOrder = [];\n    let Coupons = state.Coupon;\n\n    if (state.orderhistory && state.orderhistory.length !== 0) {\n      // cartのIDを全て商品情報に変換 Item, Topping, subtotal を追加\n      getOrder = state.orderhistory.map(o => {\n        o.cartItemList = o.cartItemList.map(c => {\n          c.Item = GetItemById(c.Itemid, state.Coffee);\n          c.Topping = c.toppingid.map(t => GetItemById(t, state.Topping));\n          c.subtotal = (c.Item[c.price] + (c.Topping.length !== 0 && c.Topping.reduce((ac, cu) => ac + cu[c.price], 0))) * (c.number * 1);\n          return c;\n        });\n        o.couponPrice = Coupons ? o.couponCode.reduce((a, c) => GetDiscountByCoupon(c, Coupons) + a, 0) : 0;\n        return o;\n      });\n      setOrder(getOrder);\n      setCoupons(Coupons);\n    }\n  }, [state]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u904E\\u53BB\\u306E\\u3054\\u6CE8\\u6587\\u5C65\\u6B74\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TableContainer, {\n      component: Paper,\n      children: state.user.uid ? order.length !== 0 ? order.map((o, i) => /*#__PURE__*/_jsxDEV(Table, {\n        \"aria-label\": \"simple table\",\n        children: [/*#__PURE__*/_jsxDEV(TableHead, {\n          className: \"chumon-head\",\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"\\u5546\\u54C1\\u540D\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 62,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"\\u30B5\\u30A4\\u30BA\\u3001\\u4FA1\\u683C\\u3001\\u6570\\u91CF\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 63,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"\\u30C8\\u30C3\\u30D4\\u30F3\\u30B0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 64,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"\\u5C0F\\u8A08\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 65,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n          className: \"chumon\",\n          children: o.cartItemList.map((c, index) => {\n            return /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                component: \"th\",\n                scope: \"row\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `${process.env.PUBLIC_URL}/${c.Item.image}`,\n                  height: \"100px\",\n                  alt: \"\\u5546\\u54C1\",\n                  style: {\n                    borderRadius: 5\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 73,\n                  columnNumber: 19\n                }, this), c.Item.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 72,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: [c.price.replace('price', '') + 'サイズ', \"\\u3001\", c.Item[c.price], \"\\u5186\\u3001\", c.number, \"\\u500B\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 76,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                  children: c.Topping.map((t, i) => {\n                    return /*#__PURE__*/_jsxDEV(\"li\", {\n                      children: [t.name, \"\\u3001\", t[c.price], \"\\u5186\"]\n                    }, i, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 81,\n                      columnNumber: 23\n                    }, this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 78,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 77,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: [c.subtotal, \"\\u5186\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 17\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 15\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n          className: \"chumon-head\",\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: /*#__PURE__*/_jsxDEV(TableCell, {\n              className: \"chumon-1\",\n              colSpan: 4,\n              children: \"\\u5408\\u8A08\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n          className: \"chumon-total\",\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              colSpan: 3\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: [\"\\u5408\\u8A08\\u91D1\\u984D:\", o.cartItemList.reduce((a, c) => c.subtotal + a, 0), \"\\u5186\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n          className: \"chumon-head\",\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: /*#__PURE__*/_jsxDEV(TableCell, {\n              className: \"chumon-1\",\n              colSpan: 4,\n              children: \"\\u5272\\u5F15\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n          className: \"chumon-total\",\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              colSpan: 3\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: [\"\\u5272\\u5F15\\u984D - \", o.couponPrice, \"\\u5186\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n          className: \"chumon-head\",\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: /*#__PURE__*/_jsxDEV(TableCell, {\n              className: \"chumon-1\",\n              colSpan: 4,\n              children: \"\\u7DCF\\u984D\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n          className: \"chumon-total\",\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              colSpan: 3\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              children: o.couponPrice ? /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\"\\u7DCF\\u984D:\", o.cartItemList.reduce((a, c) => c.subtotal + a, 0) - o.couponPrice, \"\\u5186\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 34\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\"\\u7DCF\\u984D:\", o.cartItemList.reduce((a, c) => c.subtotal + a, 0), \"\\u5186\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 123\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this)]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this)) : /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h3\",\n        children: \"\\u6CE8\\u6587\\u5C65\\u6B74\\u304C\\u3042\\u308A\\u307E\\u305B\\u3093\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this) : /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h3\",\n        children: \"\\u30ED\\u30B0\\u30A4\\u30F3\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n}\n\n_s(OrderHistory, \"cBMnizJoYy5qewKkmIQ0oVmIsUI=\", false, function () {\n  return [useSelector];\n});\n\n_c = OrderHistory;\nexport default OrderHistory;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderHistory\");","map":{"version":3,"sources":["/Users/kiritoshimura/Desktop/coffee-app/src/views/OrderHistory.js"],"names":["useSelector","useState","useEffect","GetItemById","GetDiscountByCoupon","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","Typography","OrderHistory","state","order","setOrder","couponCode","setCouponCode","couponPrice","setCouponPrice","Coupons","setCoupons","allowCoupon","i","length","code","coupon","price","getOrder","Coupon","orderhistory","map","o","cartItemList","c","Item","Itemid","Coffee","Topping","toppingid","t","subtotal","reduce","ac","cu","number","a","user","uid","index","process","env","PUBLIC_URL","image","borderRadius","name","replace"],"mappings":";;;AAAA,SAASA,WAAT,QAA4B,aAA5B;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SAASC,WAAT,EAAsBC,mBAAtB,QAAiD,qBAAjD,C,CAEA;;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,cAAP,MAA2B,kCAA3B;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,QAAP,MAAqB,4BAArB;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;;;AAEA,SAASC,YAAT,GAAwB;AAAA;;AACtB,QAAMC,KAAK,GAAGd,WAAW,CAACc,KAAK,IAAIA,KAAV,CAAzB;AACA,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBf,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACgB,UAAD,EAAaC,aAAb,IAA8BjB,QAAQ,CAAC,EAAD,CAA5C,CAHsB,CAG4B;;AAClD,QAAM,CAACkB,WAAD,EAAaC,cAAb,IAA8BnB,QAAQ,CAAC,EAAD,CAA5C,CAJsB,CAI2B;;AACjD,QAAM,CAACoB,OAAD,EAASC,UAAT,IAAsBrB,QAAQ,CAAC,EAAD,CAApC,CALsB,CAKkB;;AAExC,QAAMsB,WAAW,GAAC,MAAI;AACpB,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,OAAO,CAACI,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;AACvC,UAAIH,OAAO,CAACG,CAAD,CAAP,CAAWE,IAAX,KAAoBT,UAAxB,EAAoC;AAChC,YAAIU,MAAM,GAAGN,OAAO,CAACG,CAAD,CAAP,CAAWI,KAAxB;AACH;AACF;AACF,GAND;;AAQA1B,EAAAA,SAAS,CAAC,MAAI;AACZ,QAAI2B,QAAQ,GAAG,EAAf;AACA,QAAIR,OAAO,GAAGP,KAAK,CAACgB,MAApB;;AAEA,QAAIhB,KAAK,CAACiB,YAAN,IAAsBjB,KAAK,CAACiB,YAAN,CAAmBN,MAAnB,KAA8B,CAAxD,EAA0D;AACxD;AACAI,MAAAA,QAAQ,GAAGf,KAAK,CAACiB,YAAN,CAAmBC,GAAnB,CAAwBC,CAAC,IAAI;AACtCA,QAAAA,CAAC,CAACC,YAAF,GAAiBD,CAAC,CAACC,YAAF,CAAeF,GAAf,CAAmBG,CAAC,IAAI;AACrCA,UAAAA,CAAC,CAACC,IAAF,GAASjC,WAAW,CAACgC,CAAC,CAACE,MAAH,EAAWvB,KAAK,CAACwB,MAAjB,CAApB;AACAH,UAAAA,CAAC,CAACI,OAAF,GAAYJ,CAAC,CAACK,SAAF,CAAYR,GAAZ,CAAiBS,CAAC,IAAItC,WAAW,CAACsC,CAAD,EAAI3B,KAAK,CAACyB,OAAV,CAAjC,CAAZ;AACAJ,UAAAA,CAAC,CAACO,QAAF,GAAa,CAAEP,CAAC,CAACC,IAAF,CAAOD,CAAC,CAACP,KAAT,KAAqBO,CAAC,CAACI,OAAF,CAAUd,MAAV,KAAoB,CAApB,IAAyBU,CAAC,CAACI,OAAF,CAAUI,MAAV,CAAiB,CAACC,EAAD,EAAIC,EAAJ,KAAWD,EAAE,GAAGC,EAAE,CAACV,CAAC,CAACP,KAAH,CAAnC,EAA6C,CAA7C,CAA9C,CAAF,KAAsGO,CAAC,CAACW,MAAF,GAAW,CAAjH,CAAb;AACA,iBAAOX,CAAP;AACH,SALgB,CAAjB;AAMAF,QAAAA,CAAC,CAACd,WAAF,GAAgBE,OAAO,GAAGY,CAAC,CAAChB,UAAF,CAAa0B,MAAb,CAAoB,CAACI,CAAD,EAAGZ,CAAH,KAAS/B,mBAAmB,CAAC+B,CAAD,EAAGd,OAAH,CAAnB,GAAiC0B,CAA9D,EAAgE,CAAhE,CAAH,GAAwE,CAA/F;AACA,eAAOd,CAAP;AACD,OATU,CAAX;AAUAjB,MAAAA,QAAQ,CAACa,QAAD,CAAR;AACAP,MAAAA,UAAU,CAACD,OAAD,CAAV;AACD;AACF,GAnBQ,EAmBP,CAACP,KAAD,CAnBO,CAAT;AAqBA,sBACE;AAAA,4BACE;AAAA;AAAA;AAAA;AAAA,YADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFF,eAGA,QAAC,cAAD;AAAgB,MAAA,SAAS,EAAEH,KAA3B;AAAA,gBACCG,KAAK,CAACkC,IAAN,CAAWC,GAAX,GACClC,KAAK,CAACU,MAAN,KAAiB,CAAjB,GACEV,KAAK,CAACiB,GAAN,CAAU,CAACC,CAAD,EAAGT,CAAH,kBACV,QAAC,KAAD;AAAe,sBAAW,cAA1B;AAAA,gCACE,QAAC,SAAD;AAAW,UAAA,SAAS,EAAC,aAArB;AAAA,iCACE,QAAC,QAAD;AAAA,oCACE,QAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE,QAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHF,eAIE,QAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eASE,QAAC,SAAD;AAAW,UAAA,SAAS,EAAC,QAArB;AAAA,oBACCS,CAAC,CAACC,YAAF,CAAeF,GAAf,CAAmB,CAACG,CAAD,EAAIe,KAAJ,KAAc;AAC9B,gCACA,QAAC,QAAD;AAAA,sCACE,QAAC,SAAD;AAAW,gBAAA,SAAS,EAAC,IAArB;AAA0B,gBAAA,KAAK,EAAC,KAAhC;AAAA,wCACE;AAAK,kBAAA,GAAG,EAAG,GAAEC,OAAO,CAACC,GAAR,CAAYC,UAAW,IAAGlB,CAAC,CAACC,IAAF,CAAOkB,KAAM,EAApD;AAAuD,kBAAA,MAAM,EAAC,OAA9D;AAAsE,kBAAA,GAAG,EAAC,cAA1E;AAA+E,kBAAA,KAAK,EAAE;AAACC,oBAAAA,YAAY,EAAC;AAAd;AAAtF;AAAA;AAAA;AAAA;AAAA,wBADF,EAEGpB,CAAC,CAACC,IAAF,CAAOoB,IAFV;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAKE,QAAC,SAAD;AAAA,2BAAYrB,CAAC,CAACP,KAAF,CAAQ6B,OAAR,CAAgB,OAAhB,EAAwB,EAAxB,IAA8B,KAA1C,YAAkDtB,CAAC,CAACC,IAAF,CAAOD,CAAC,CAACP,KAAT,CAAlD,kBAAqEO,CAAC,CAACW,MAAvE;AAAA;AAAA;AAAA;AAAA;AAAA,sBALF,eAME,QAAC,SAAD;AAAA,uCACE;AAAA,4BACCX,CAAC,CAACI,OAAF,CAAUP,GAAV,CAAc,CAACS,CAAD,EAAGjB,CAAH,KAAS;AACtB,wCACE;AAAA,iCAAaiB,CAAC,CAACe,IAAf,YAAsBf,CAAC,CAACN,CAAC,CAACP,KAAH,CAAvB;AAAA,uBAASJ,CAAT;AAAA;AAAA;AAAA;AAAA,4BADF;AAGD,mBAJA;AADD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,sBANF,eAeE,QAAC,SAAD;AAAA,2BAAYW,CAAC,CAACO,QAAd;AAAA;AAAA;AAAA;AAAA;AAAA,sBAfF;AAAA,eAAeQ,KAAf;AAAA;AAAA;AAAA;AAAA,oBADA;AAkBC,WAnBJ;AADD;AAAA;AAAA;AAAA;AAAA,gBATF,eAgCE,QAAC,SAAD;AAAW,UAAA,SAAS,EAAC,aAArB;AAAA,iCACE,QAAC,QAAD;AAAA,mCACE,QAAC,SAAD;AAAW,cAAA,SAAS,EAAC,UAArB;AAAgC,cAAA,OAAO,EAAE,CAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAhCF,eAqCE,QAAC,SAAD;AAAW,UAAA,SAAS,EAAC,cAArB;AAAA,iCACE,QAAC,QAAD;AAAA,oCACE,QAAC,SAAD;AAAW,cAAA,OAAO,EAAE;AAApB;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,SAAD;AAAA,sDAAiBjB,CAAC,CAACC,YAAF,CAAeS,MAAf,CAAuB,CAACI,CAAD,EAAGZ,CAAH,KAASA,CAAC,CAACO,QAAF,GAAaK,CAA7C,EAAgD,CAAhD,CAAjB;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBArCF,eA2CE,QAAC,SAAD;AAAW,UAAA,SAAS,EAAC,aAArB;AAAA,iCACE,QAAC,QAAD;AAAA,mCACE,QAAC,SAAD;AAAW,cAAA,SAAS,EAAC,UAArB;AAAgC,cAAA,OAAO,EAAE,CAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBA3CF,eAiDE,QAAC,SAAD;AAAW,UAAA,SAAS,EAAC,cAArB;AAAA,iCACE,QAAC,QAAD;AAAA,oCACE,QAAC,SAAD;AAAY,cAAA,OAAO,EAAE;AAArB;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,SAAD;AAAA,kDAAkBd,CAAC,CAACd,WAApB;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAjDF,eAuDE,QAAC,SAAD;AAAW,UAAA,SAAS,EAAC,aAArB;AAAA,iCACE,QAAC,QAAD;AAAA,mCACE,QAAC,SAAD;AAAW,cAAA,SAAS,EAAC,UAArB;AAAgC,cAAA,OAAO,EAAE,CAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAvDF,eA4DE,QAAC,SAAD;AAAW,UAAA,SAAS,EAAC,cAArB;AAAA,iCACE,QAAC,QAAD;AAAA,oCACE,QAAC,SAAD;AAAW,cAAA,OAAO,EAAE;AAApB;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,SAAD;AAAA,wBACGc,CAAC,CAACd,WAAF,gBAAgB;AAAA,4CAAUc,CAAC,CAACC,YAAF,CAAeS,MAAf,CAAuB,CAACI,CAAD,EAAGZ,CAAH,KAASA,CAAC,CAACO,QAAF,GAAaK,CAA7C,EAAgD,CAAhD,IAAsDd,CAAC,CAACd,WAAlE;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAhB,gBAAyG;AAAA,4CAAUc,CAAC,CAACC,YAAF,CAAeS,MAAf,CAAuB,CAACI,CAAD,EAAGZ,CAAH,KAASA,CAAC,CAACO,QAAF,GAAaK,CAA7C,EAAgD,CAAhD,CAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAD5G;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBA5DF;AAAA,SAAYvB,CAAZ;AAAA;AAAA;AAAA;AAAA,cADA,CADF,gBA0EE,QAAC,UAAD;AAAY,QAAA,OAAO,EAAC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cA3EH,gBA6EC,QAAC,UAAD;AAAY,QAAA,OAAO,EAAC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA9EF;AAAA;AAAA;AAAA;AAAA,YAHA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAuFD;;GA3HQX,Y;UACOb,W;;;KADPa,Y;AA6HT,eAAeA,YAAf","sourcesContent":["import { useSelector } from \"react-redux\";\nimport { useState, useEffect } from \"react\";\nimport { GetItemById, GetDiscountByCoupon } from '../components/Items'\n\n// material ui\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nfunction OrderHistory() {\n  const state = useSelector(state => state);\n  const [order, setOrder] = useState([])\n  const [couponCode, setCouponCode] = useState(''); //クーポンコード\n  const [couponPrice,setCouponPrice] =useState('') //割引額\n  const [Coupons,setCoupons] =useState('')//クーポン\n\n  const allowCoupon=()=>{\n    for (let i = 0; i < Coupons.length; i++) {\n      if (Coupons[i].code === couponCode) {\n          let coupon = Coupons[i].price\n      }\n    }\n  }\n\n  useEffect(()=>{    \n    let getOrder = []   \n    let Coupons = state.Coupon\n \n    if( state.orderhistory && state.orderhistory.length !== 0){\n      // cartのIDを全て商品情報に変換 Item, Topping, subtotal を追加\n      getOrder = state.orderhistory.map( o => { \n        o.cartItemList = o.cartItemList.map(c => {            \n            c.Item = GetItemById(c.Itemid, state.Coffee)\n            c.Topping = c.toppingid.map( t => GetItemById(t, state.Topping) )\n            c.subtotal = ( c.Item[c.price] +  ( c.Topping.length !==0 && c.Topping.reduce((ac,cu) => ac + cu[c.price],0))) * ( c.number * 1 )\n            return c\n        })\n        o.couponPrice = Coupons ? o.couponCode.reduce((a,c) => GetDiscountByCoupon(c,Coupons) + a,0) : 0   \n        return o        \n      })      \n      setOrder(getOrder)\n      setCoupons(Coupons)\n    }            \n  },[state])  \n\n  return (\n    <div>\n      <p></p>\n      <h2>過去のご注文履歴</h2>\n    <TableContainer component={Paper}>\n    {state.user.uid ? \n      order.length !== 0 ? \n        order.map((o,i) => (\n        <Table key={i} aria-label=\"simple table\">\n          <TableHead className='chumon-head'>\n            <TableRow>\n              <TableCell>商品名</TableCell>\n              <TableCell>サイズ、価格、数量</TableCell>\n              <TableCell>トッピング</TableCell>\n              <TableCell>小計</TableCell>              \n            </TableRow>\n          </TableHead>\n          <TableBody className='chumon'>\n          {o.cartItemList.map((c, index) => {            \n              return (\n              <TableRow key={index}>\n                <TableCell component=\"th\" scope=\"row\">\n                  <img src={`${process.env.PUBLIC_URL}/${c.Item.image}`} height=\"100px\" alt=\"商品\" style={{borderRadius:5}}/>\n                  {c.Item.name}\n                </TableCell>\n                <TableCell>{c.price.replace('price','') + 'サイズ'}、{c.Item[c.price]}円、{c.number}個</TableCell>              \n                <TableCell>\n                  <ul>                     \n                  {c.Topping.map((t,i) => {                  \n                    return (\n                      <li key={i}>{t.name}、{t[c.price]}円</li>\n                    )\n                  })}\n                  </ul> \n                </TableCell>\n                <TableCell>{c.subtotal}円</TableCell> \n              </TableRow>)\n              })         \n            }\n          </TableBody>\n          <TableHead className='chumon-head'>\n            <TableRow>\n              <TableCell className=\"chumon-1\" colSpan={4}>合計</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableHead className='chumon-total'>\n            <TableRow>\n              <TableCell colSpan={3}></TableCell>\n              <TableCell>合計金額:{o.cartItemList.reduce( (a,c) => c.subtotal + a, 0 )}円</TableCell>                \n            </TableRow>\n          </TableHead>\n          <TableHead className='chumon-head'>\n            <TableRow>\n              <TableCell className=\"chumon-1\" colSpan={4}>割引</TableCell>\n            </TableRow>\n          </TableHead>\n\n          <TableHead className='chumon-total'>\n            <TableRow>\n              <TableCell  colSpan={3}></TableCell>\n              <TableCell>割引額 - {o.couponPrice}円</TableCell>  \n            </TableRow>\n          </TableHead>\n          <TableHead className='chumon-head'>\n            <TableRow>\n              <TableCell className=\"chumon-1\" colSpan={4}>総額</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableHead className='chumon-total'>\n            <TableRow>\n              <TableCell colSpan={3}></TableCell>\n              <TableCell>       \n                {o.couponPrice ? <span>総額:{o.cartItemList.reduce( (a,c) => c.subtotal + a, 0 ) - o.couponPrice}円</span> : <span>総額:{o.cartItemList.reduce( (a,c) => c.subtotal + a, 0 )}円</span>}\n                </TableCell>  \n            </TableRow>\n          </TableHead>\n          \n        </Table>\n        ))\n        :\n        <Typography variant=\"h3\">注文履歴がありません</Typography>\n      :\n      <Typography variant=\"h3\">ログインしてください</Typography>\n    }     \n    </TableContainer>     \n    </div>\n  );\n}\n\nexport default OrderHistory;"]},"metadata":{},"sourceType":"module"}